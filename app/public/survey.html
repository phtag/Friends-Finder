<html lang="en"><head>
    <meta charset="UTF-8">
    <title>FriendFinder</title>
  
    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  
    <!-- Font Awesome Glyphicons -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
  
    <!-- Chosen -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>
  
  </head>
  
  <body>
  
    <div class="container">
      <h2>Survey Questions</h2>
      <hr>
      <h3><strong>Your information</strong></h3>
      <h4>Name (Required)</h4>
      <input type="text" id="name" class="user-data" required="">
  
      <h4>Link to Photo Image (Required)</h4>
      <input type="text" id="photo" class="user-data" required="">
      <hr>
      <h3><strong>Question 1</strong></h3>
      <h4>You are always thinking of ways to make the world a better place to live in.</h4>
      <select class="survey-selections" id="question-1" style="width: 165px;">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
      </select>      
      <h3><strong>Question 2</strong></h3>
      <h4>On a rainy, cold and dark day, you enjoy the opportunity to catch up on reading a good book.</h4>
      <select class="survey-selections" id="question-2" style="width: 165px;">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
      </select>
      <h3><strong>Question 3</strong></h3>
      <h4>For you, having friends is more important than being successful in your career.</h4>
      <select class="survey-selections" id="question-3" style="width: 165px;">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
      </select>
      <h3><strong>Question 4</strong></h3>
      <h4>When the weekend comes, you just want to be outdoors doing some form of physical activity.</h4>
      <select class="survey-selections" id="question-4" style="width: 165px;">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
      </select>
      <h3><strong>Question 5</strong></h3>
      <h4>You think that government is necessary and basically an overall benefit to your country.</h4>
      <select class="survey-selections" id="question-5" style="width: 165px;">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>
      <h3><strong>Question 6</strong></h3>
      <h4>Most of the movies made in Hollywood are shallow and not worth watching.</h4>
      <select class="survey-selections" id="question-6" style="width: 165px;">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>
      <h3><strong>Question 7</strong></h3>
      <h4>Overall, you think the internet has made the world a better place.</h4>
      <select class="survey-selections" id="question-7" style="width: 165px;">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select> 
      <h3><strong>Question 8</strong></h3>
      <h4>You think that the environment is something to be used by people and doesn't need to be protected.</h4>
      <select class="survey-selections" id="question-8" style="width: 165px;">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>                         
      <h3><strong>Question 9</strong></h3>
      <h4>When a discussion gets heated, you tend to back off and make peace with the people you are talking to.</h4>
      <select class="survey-selections" id="question-9" style="width: 165px;">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>                         
      <h3><strong>Question 10</strong></h3>
      <h4>You are a kind and generous person who would do most anything for your family and loyal friends.</h4>
      <select class="survey-selections" id="question-10" style="width: 165px;">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>                         
                        
      <br>
      <br>
  
      <!-- Submit Button -->
      <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit-survey"><i class="fa fa-check-circle" aria-hidden="true"></i>
       Submit</button>
  
      <hr>
      <footer class="footer">
        <div class="container">
          <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/afhaque/friendfinder">GitHub Repo</a></p>
        </div>
      </footer>
  
    </div>
  /
    <div id="results-modal" class="modal fade" role="dialog">
      <div class="modal-dialog">
  
        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">Ã—</button>
            <h2 class="modal-title"><strong>Best Match For You</strong></h2>
          </div>
          <div class="modal-body">
            <h2 id="matched-name"></h2>
            <img id="matched-image" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg" alt="">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>  
      </div>
    </div>
  
    <script type="text/javascript">
    // user input validation function
    function validateUserInputs() {
      var inputsValid = true;
  // Make sure user data has been filled in
      $(".user-data").each(function(index, object) {
        if ($(object).val() === "") {
          inputsValid = false;
        }
      });
//  make sure all survey questions have been answered
      $(".survey-selections").each(function(index, object) { 
        if ($(object).val() === "") {
          inputsValid = false;
        }
      });
      return inputsValid;
    }

    // Respond to survey submission
    $("#submit-survey").on("click", function(event) {

      event.preventDefault();
  
      // If all required fields are filled
      if (validateUserInputs()) {
        // Create an object for the user"s data
        var userInputData = {
          name: $("#name").val(),
          photo: $("#photo").val(),
          scores: []
        };
        for (i=1;i<=10;i++){
          $("#question-"+i).each(function(index, object) { 
            userInputData.scores.push($(object).val());
          });
        }
        // AJAX post the data to the friends API.
        $.post("/api/friends", userInputData, function(response) { 
          console.log(response);
          // Grab the result from the AJAX post so that the best match's name and photo are displayed.
          $("#matched-name").text(response.name);
          $("#matched-image").attr("src", response.photo);

          // Show the modal with the best match
          $("#results-modal").modal("toggle");

        });
      } else {
        alert("You must fill in all required information and answer all survey questions before submitting!");
      }
    });
    </script>
  </body>
  </html>